<div ng-controller="commentController" ng-show="displayComments" class="comments">

    <div ng-include="'templates/comment.html'"></div>

    <div ng-repeat="comment in post.comments" class="panel panel-default">

        <div class="panel-heading">
            <div class="panel-title">
                <a href="#/user/{{comment.author.username}}/wall" title="{{comment.author.name}}">
                    <img ng-src="{{comment.author.profileImageData || 'resources/defaultProfileImage.png'}}"
                         class="lil-thumbnail"/>
                </a>

                <p class="info">
                    <span class="author comment-author">
                        <a href="#/user/{{comment.author.username}}/wall">
                            {{comment.author.name}}
                        </a>
                    </span>
                    <span class="date comment-date">{{comment.date |date: "dd MMM yyyy HH:mm:ss"}}</span>
                    <span ng-if="comment.author.username === username" class="controls">
                        <a href=""
                           ng-click="comment.editing = true; comment.newCommentContent = comment.commentContent">
                            <span class="glyphicon glyphicon-pencil"></span> Edit
                        </a>
                        <a href="" ng-click="deleteComment(post, comment)">
                            <span class="glyphicon glyphicon-remove"></span> Delete
                        </a>
                    </span>
                </p>
            </div>
        </div>

        <div class="panel-body">
            <span ng-if="!comment.editing">
                {{comment.commentContent}}
            </span>
            <br/>

            <form ng-show="comment.editing" name="editCommentForm"
                  ng-submit="editComment(post, comment); comment.editing = false">
                <input type="text" ng-model="comment.newCommentContent" ng-minlength="1" required/>
                <button type="submit" ng-disabled="editCommentForm.$invalid">Save</button>
                <a ng-click="comment.editing = false">Cancel</a>
            </form>

            <!-- likes -->
            <span class="right">
                <a href="" ng-if="!comment.liked" ng-click="likeComment(post, comment)">Like</a>
                <a href="" ng-if="comment.liked" ng-click="unlikeComment(post, comment)">Unlike</a>
                <span class="badge">{{comment.likesCount}}</span>
            </span>

        </div>

    </div>
</div>